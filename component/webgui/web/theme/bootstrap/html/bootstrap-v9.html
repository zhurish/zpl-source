<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta content="" name="description" />
    <meta content="webthemez" name="author" />
    <!-- Bootstrap Styles-->
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/bootstrap-switch.min.css" rel="stylesheet" />

    <!-- private Styles-->
    <link href="../css/private.css" rel="stylesheet" />

    <!-- jQuery Js -->
    <script src="../js/jquery-2.1.1.min.js"></script>
    <!-- Bootstrap Js -->
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/bootstrap-switch.min.js"></script>


    <script src="../js/bootstrap-menu.js"></script>

    <script src="../js/xhr.js"></script>
    <script src="../js/data-type.js"></script>
    <style>

    </style>
    <title>TSL-V9 WEB 配置页面</title>
</head>

<body>
    <header class="header">
        <nav class="navbar">
            <div class="container-fluid">
                <div class="navbar-header" style="margin-left:25px">
                    <h class="navbar-brand">TSLSmart (login: <%jst_username();%>)</h>
                </div>
                <div style="text-align:center;margin-left: 45%;">
                    <h class="navbar-brand" style="font-weight:bold;"><%jst_web_header();%></h>
                </div>
            </div>
        </nav>
    </header>
    <script type="text/javascript">
    function web_define() {
        $.get("/goform/web-define", function (data, status) {
        console.log(data);
        var data_json = JSON.parse(data);
        $.each(data_json, function (index, info) {	

            sessionStorage.setItem("webtype", info.webtype);
            sessionStorage.setItem("ostype", info.ostype);
            sessionStorage.setItem("platform", info.platform);
            sessionStorage.setItem("device", info.device);
            if(info.switch)
                sessionStorage.setItem("switch", 1);
            else
                sessionStorage.setItem("switch", 0);

            if(info.dns)
                sessionStorage.setItem("dns", 1);
            else
                sessionStorage.setItem("dns", 0);
            if(info.dhcp)
                sessionStorage.setItem("dhcp", 1);
            else
                sessionStorage.setItem("dhcp", 0);

            if(info.sip)
                sessionStorage.setItem("sip", 1);
            else
                sessionStorage.setItem("sip", 0);
                
            if(info.wireless)
                sessionStorage.setItem("wireless", 1);
            else
                sessionStorage.setItem("wireless", 0); 
            });
        });
    }
    web_define();
    </script>
    <div class="main">
        <div style="display: none;" class="loading">
            <span>
                <div class="loading-img"></div>Loading...
            </span>
        </div>

        <!--div class="row" -->
        <div class="col-sm-2 ">
            <nav class="navbar" role="navigation" style="background-color: #eee;">
                <!--nav class="navbar navbar-inverse" role="navigation"-->
                <div class="container-fluid">
                    <div>
                        <ul class="nav nav-pills nav-stacked">
                            <!--li><a href="#auto">Auto Setting</a></li-->

                            <li class="dropdown active">
                                <a class="dropdown-toggle" data-toggle="dropdown"> Status <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="active"><a href="#systemview">systemview</a></li>
                                    <li><a href="#syslog">syslog</a></li>
                                </ul>
                            </li>

                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown"> System <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li><a href="#system">system</a></li>
                                    <!--li><a href="#admin">admin</a></li-->
                                    <li><a href="#filesystem">filesystem</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown"> Network <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <script type="text/javascript">
                                        if(1 == sessionStorage.getItem("switch"))
                                            document.write("<li><a href=\"#switch\">switch</a></li>");
                                    </script>
                                    <!--li><a href="#switch">switch</a></li-->
                                    <li><a href="#network">network</a></li>
                                    <script type="text/javascript">
                                        if(1 == sessionStorage.getItem("dhcp"))
                                            document.write("<li><a href=\"#dhcp\">dhcp</a></li>");
                                        if(1 == sessionStorage.getItem("wireless"))
                                            document.write("<li><a href=\"#wireless\">wireless</a></li>");
                                    </script>
                                    <!--li><a href="#dhcp">dhcp</a></li-->
                                    <!--li><a href="#route">route</a></li-->
                                    <!--li><a href="#firewall">firewall</a></li-->
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown"> Service <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <script type="text/javascript">
                                        if(1 == sessionStorage.getItem("sip"))
                                            document.write("<li><a href=\"#sip\">sip</a></li>");

                                        if("TSLV9" == sessionStorage.getItem("device")) 
                                        {
                                            document.write("<li><a href=\"#general\">General</a></li>");
                                            document.write("<li><a href=\"#rtsp\">RtspStream</a></li>");   
                                            document.write("<li><a href=\"#algorithm\">Algorithm</a></li>");
                                            document.write("<li><a href=\"#facelib\">FaceLib</a></li>");
                                            document.write("<li><a href=\"#boardcard\">BoardStatus</a></li>");
                                        }
                         
                                    </script>
                                </ul>
                            </li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#reboot">Reboot</a></li>
                            <li><a id="logout" href="/action/logout">Logout</a></li>
                        </ul>
                    </div>
                </div>
        </div>
        </nav>
        <div class="col-sm-10">
            <!--style="overflow:auto; overflow-y:scroll; ;"-->
            <div style="height: 650px;">
                <iframe id="main_content" width="100%" height="100%" frameborder="0" scrolling="yes">
                </iframe>

            </div>

            <footer class="mobile-hide">
                <p><% jst_web_description(); %> (<%jst_web_version();%>)</p>
            </footer>
        </div>

        <script type="text/javascript">
            var lastTime = new Date().getTime();
            var currentTime = new Date().getTime();
            //设置超时时间： 10分
            var timeOut = 1 * 60 * 1000; 

            window.onload = function () {
                web_define();

                load_main_page("systemview", "#maincontent");
                /* 检测鼠标移动事件 */
                document.addEventListener('mousemove', function () {
                    // 更新最后的操作时间
                    lastTime = new Date().getTime();
                });
            }

            /* 定时器  间隔1分钟，检测是否长时间未操作页面  */
            var quitTime = window.setInterval(testTime, 10000);
            // 超时函数
            function testTime() {
                //更新当前时间
                currentTime = new Date().getTime();
                console.log('currentTime', currentTime)
                //判断是否超时
                if (currentTime - lastTime > timeOut) {
                    console.log('超时拉')
                    // 超时操作
                    // 清除掉定时器
                    window.clearInterval(quitTime);
                    $('logout').click();
                }
            }
        </script>
    </div>
    </div>
</body>

</html>